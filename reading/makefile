#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#/////////////////////////////////////////////////////////////////// VARIABLES //////////////////////////////////////////////////////////////////////////
#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
CC = gcc
CL = clean
BIN_DIR = ./bin
SRC_DIR = ./src
OBJ_DIR = ./obj
MAIN_OBJ = $(OBJ_DIR)/main.o
PIPE_OBJ = $(OBJ_DIR)/reading.o
MAIN_SRC = $(SRC_DIR)/main.c
PIPE_SRC = $(SRC_DIR)/reading.c
EXEC = $(BIN_DIR)/reading
C_FLAGS = -g -Wall
LIB_FLAGS = -lpng

#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#//////////////////////////////////////////////////////////////////// TARGETS ///////////////////////////////////////////////////////////////////////////
#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
# - DESCRIPTION:

.PHONY: all
all: inimsj $(EXEC) endmsj

$(EXEC): clean bin obj $(MAIN_OBJ) $(PIPE_OBJ)
	@echo '-------------------------------------------------------------------------'
	@echo ' => Compiling target "$(@F)"'
	$(CC) $(C_FLAGS) $(MAIN_OBJ) $(PIPE_OBJ) -o $@ $(LIB_FLAGS)
	@echo ' => "$(@F)" compiled in the directory "$(@D)"'
	@echo ' => Enter the directory "$(@D)" by typing: cd $(@D)'
	@echo ' => Execute the program by typing: ./$(@F)'
	@echo ' => For any problem check the README file'
	@echo '-------------------------------------------------------------------------'

#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
# - DESCRIPTION:

$(MAIN_OBJ): $(MAIN_SRC)
	@echo '-------------------------------------------------------------------------'
	@echo ' => Compiling target "$(@F)"'
	$(CC) $(C_FLAGS) -c $< -o $@
	@echo ' => "$(@F)" compiled in the directory "$(@D)"'
	@echo '-------------------------------------------------------------------------'

$(PIPE_OBJ): $(PIPE_SRC)
	@echo '-------------------------------------------------------------------------'
	@echo ' => Compiling target "$(@F)"'
	$(CC) $(C_FLAGS) -c $< -o $@
	@echo ' => "$(@F)" compiled in the directory "$(@D)"'
	@echo '-------------------------------------------------------------------------'

#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
# - DESCRIPTION:

.PHONY: inimsj
inimsj:
	@echo '/////////////////////////////////////////////////////////////////////////'
	@echo ' => Compiling "reading" program'
	@echo '-------------------------------------------------------------------------'

.PHONY: endmsj
endmsj:
	@echo '/////////////////////////////////////////////////////////////////////////'

#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
# - DESCRIPTION:

.PHONY: bin
bin: 
	@echo '-------------------------------------------------------------------------'
	@echo ' => Creating direcotry "$@"'
	mkdir $(BIN_DIR)
	@echo '-------------------------------------------------------------------------'

.PHONY: obj
obj: 
	@echo '-------------------------------------------------------------------------'
	@echo ' => Creating direcotry "$@"'
	mkdir $(OBJ_DIR)
	@echo '-------------------------------------------------------------------------'

#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
# - DESCRIPTION:
.PHONY: clean
clean: 
	@echo '-------------------------------------------------------------------------'
	@echo ' => Deleting directory "$(BIN_DIR)" and directory "$(OBJ_DIR)" compilation contents'
	rm -rf $(BIN_DIR)
	rm -rf $(OBJ_DIR)
	@echo '-------------------------------------------------------------------------'

#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////