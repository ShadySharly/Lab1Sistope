#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#/////////////////////////////////////////////////////////////////// VARIABLES //////////////////////////////////////////////////////////////////////////
#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
CC = gcc
BIN_DIR = ./bin
SRC_DIR = ./src
EXE_NAME = pipeline.exe
C_FLAGS = -c -Wall

#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#//////////////////////////////////////////////////////////////////// TARGETS ///////////////////////////////////////////////////////////////////////////
#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
# Esta es la target que se ejecuta por defecto si se escribe "make" en la consola
all: release

# Compilación principal del ejecutable
release: clean make_bin main.o pipeline.o 
	$(CC) main.o  pipeline.o -o $(BIN_DIR)/$(EXE_NAME) -Wall -I.
	#@echo 'Compilando target: $@'
	#gcc $(SRC_DIR)/ejemPunteros.c -o $(DIR_OUTPUT)/$(NOMBRE_EJECUTABLE) -O2
	#@echo ' '
	#@echo $@ compilado en el directorio $(DIR_OUTPUT)
	#@echo "Ingrese al directorio '"$(DIR_OUTPUT)"' haciendo: cd "$(DIR_OUTPUT)
	#@echo "Ejecute el programa haciendo: ./"$(NOMBRE_EJECUTABLE)""
	#@echo ' '
	#@echo "Si tiene problemas, en el fichero README blablabla"

main.o: $(SRC_DIR)/main.c 
	$(CC) $(C_FLAGS) $(SRC_DIR)/main.c

pipeline.o: $(SRC_DIR)/pipeline.c 
	$(CC) $(C_FLAGS) $(SRC_DIR)/pipeline.c

make_bin:
	@echo 'Creando directorio BIN "$(BIN_DIR)"'
	mkdir -p $(BIN_DIR)

#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#Compilación con opciones de debugueo y sin optimizaciones
debug:
	@echo 'Compilando target: $@'
	mkdir -p $(BIN_DIR)
	gcc $(SRC_DIR)/main.c -o $(BIN_DIR)/$(EXE_NAME) -g3 -Wall -pedantic -DDEBUG
	@echo ' '
	@echo $@ compilado en el directorio $(BIN_DIR)
	@echo "Ingrese al directorio '"$(BIN_DIR)"' haciendo: cd "$(BIN_DIR)
	@echo "Ejecute el programa haciendo: ./"$(EXE_NAME)"
	@echo ' '
	@echo "Si tiene problemas, en el fichero README blablabla"

#////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
# Other Targets
clean:
	#Borro el contenido del directorio de compilación
	rm -rf $(BIN_DIR)/*
	-@echo ' ' 

